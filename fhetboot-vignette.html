<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />

<meta name="viewport" content="width=device-width, initial-scale=1">

<meta name="author" content="Sarah P. Flanagan" />

<meta name="date" content="2016-12-08" />

<title>Using fhetboot</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>



<link href="data:text/css;charset=utf-8,body%20%7B%0Abackground%2Dcolor%3A%20%23fff%3B%0Amargin%3A%201em%20auto%3B%0Amax%2Dwidth%3A%20700px%3B%0Aoverflow%3A%20visible%3B%0Apadding%2Dleft%3A%202em%3B%0Apadding%2Dright%3A%202em%3B%0Afont%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0Afont%2Dsize%3A%2014px%3B%0Aline%2Dheight%3A%201%2E35%3B%0A%7D%0A%23header%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0A%23TOC%20%7B%0Aclear%3A%20both%3B%0Amargin%3A%200%200%2010px%2010px%3B%0Apadding%3A%204px%3B%0Awidth%3A%20400px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Aborder%2Dradius%3A%205px%3B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Afont%2Dsize%3A%2013px%3B%0Aline%2Dheight%3A%201%2E3%3B%0A%7D%0A%23TOC%20%2Etoctitle%20%7B%0Afont%2Dweight%3A%20bold%3B%0Afont%2Dsize%3A%2015px%3B%0Amargin%2Dleft%3A%205px%3B%0A%7D%0A%23TOC%20ul%20%7B%0Apadding%2Dleft%3A%2040px%3B%0Amargin%2Dleft%3A%20%2D1%2E5em%3B%0Amargin%2Dtop%3A%205px%3B%0Amargin%2Dbottom%3A%205px%3B%0A%7D%0A%23TOC%20ul%20ul%20%7B%0Amargin%2Dleft%3A%20%2D2em%3B%0A%7D%0A%23TOC%20li%20%7B%0Aline%2Dheight%3A%2016px%3B%0A%7D%0Atable%20%7B%0Amargin%3A%201em%20auto%3B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dcolor%3A%20%23DDDDDD%3B%0Aborder%2Dstyle%3A%20outset%3B%0Aborder%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0Aborder%2Dwidth%3A%202px%3B%0Apadding%3A%205px%3B%0Aborder%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dstyle%3A%20inset%3B%0Aline%2Dheight%3A%2018px%3B%0Apadding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0Aborder%2Dleft%2Dstyle%3A%20none%3B%0Aborder%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Ap%20%7B%0Amargin%3A%200%2E5em%200%3B%0A%7D%0Ablockquote%20%7B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Apadding%3A%200%2E25em%200%2E75em%3B%0A%7D%0Ahr%20%7B%0Aborder%2Dstyle%3A%20solid%3B%0Aborder%3A%20none%3B%0Aborder%2Dtop%3A%201px%20solid%20%23777%3B%0Amargin%3A%2028px%200%3B%0A%7D%0Adl%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0Adl%20dd%20%7B%0Amargin%2Dbottom%3A%2013px%3B%0Amargin%2Dleft%3A%2013px%3B%0A%7D%0Adl%20dt%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Aul%20%7B%0Amargin%2Dtop%3A%200%3B%0A%7D%0Aul%20li%20%7B%0Alist%2Dstyle%3A%20circle%20outside%3B%0A%7D%0Aul%20ul%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Apre%2C%20code%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0Aborder%2Dradius%3A%203px%3B%0Acolor%3A%20%23333%3B%0Awhite%2Dspace%3A%20pre%2Dwrap%3B%20%0A%7D%0Apre%20%7B%0Aborder%2Dradius%3A%203px%3B%0Amargin%3A%205px%200px%2010px%200px%3B%0Apadding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Acode%20%7B%0Afont%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0Afont%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0Apadding%3A%202px%200px%3B%0A%7D%0Adiv%2Efigure%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0Abackground%2Dcolor%3A%20%23FFFFFF%3B%0Apadding%3A%202px%3B%0Aborder%3A%201px%20solid%20%23DDDDDD%3B%0Aborder%2Dradius%3A%203px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Amargin%3A%200%205px%3B%0A%7D%0Ah1%20%7B%0Amargin%2Dtop%3A%200%3B%0Afont%2Dsize%3A%2035px%3B%0Aline%2Dheight%3A%2040px%3B%0A%7D%0Ah2%20%7B%0Aborder%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Apadding%2Dbottom%3A%202px%3B%0Afont%2Dsize%3A%20145%25%3B%0A%7D%0Ah3%20%7B%0Aborder%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Afont%2Dsize%3A%20120%25%3B%0A%7D%0Ah4%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0Amargin%2Dleft%3A%208px%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Ah5%2C%20h6%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23ccc%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Aa%20%7B%0Acolor%3A%20%230033dd%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Ahover%20%7B%0Acolor%3A%20%236666ff%3B%20%7D%0Aa%3Avisited%20%7B%0Acolor%3A%20%23800080%3B%20%7D%0Aa%3Avisited%3Ahover%20%7B%0Acolor%3A%20%23BB00BB%3B%20%7D%0Aa%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0Aa%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%20code%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%0A" rel="stylesheet" type="text/css" />

</head>

<body>




<h1 class="title toc-ignore">Using fhetboot</h1>
<h4 class="author"><em>Sarah P. Flanagan</em></h4>
<h4 class="date"><em>2016-12-08</em></h4>



<p>A common way to identify loci putatively under selection in population genomics studies is to identify loci that have high differentiation Fst relative to their expected heterozygosity Ht, as described in Beaumont &amp; Nichols (1996). However, the Fst-Ht distribution changes shape based on the demographics of the population, and some distribution shapes are less conducive to identifying outliers than others. The problem of different distribution shapes is exacerbated by the current implementation of analyses which assume the same distribution for all demographic parameters. <strong>fhetboot</strong> bootstraps across the existing dataset to generate confidence intervals that approximate the actual Fst-Ht distribution.</p>
<p>This package performs several tasks.<br />
 - Parses genepop files into R.<br />
 - Calculates allele frequencies, Ht, and Fst (three commonly-used Fst calculations).<br />
 - Bootstraps across loci to generate confidence intervals.<br />
 - Generates customizable Fst-Ht plots with confidence intervals.<br />
 - Identifies loci lying outside of the confidence intervals.<br />
 - Calculates p-values for each locus based on the bootstrapped distribution</p>
<div id="getting-started" class="section level2">
<h2>Getting Started</h2>
<div id="read-in-your-data" class="section level3">
<h3>Read in your data</h3>
<p>The first step is to organize your data in the genepop format. If you’ve been using LOSITAN, the format is identical. For details on the genepop format, refer to <a href="http://genepop.curtin.edu.au/help_input.html">this website</a>. <strong>fhetboot</strong> accepts both haploid and diploid genepop files with alleles coded using either the 2- or 3-digit format.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(<span class="st">&quot;fhetboot&quot;</span>,<span class="dt">lib.loc =</span> <span class="st">&quot;~/sf_ubuntushare/fst_outliers/fhetboot&quot;</span>)
gfile&lt;-<span class="kw">system.file</span>(<span class="st">&quot;extdata&quot;</span>, <span class="st">&quot;example.genepop.txt&quot;</span>,<span class="dt">package =</span> <span class="st">'fhetboot'</span>)
gpop&lt;-<span class="kw">my.read.genepop</span>(gfile)</code></pre></div>
<pre><code>## 
## Parsing Genepop file...
## 
## 
## File description:  Numerical Analysis with Nm=10, N=1000, 75 Demes, sampling 5 populations. 
## 
## ...done.</code></pre>
<p>This function outputs any descriptors you’ve included in the header of your genepop file.This code was adapted from <a href="http://adegenet.r-forge.r-project.org/">adegenet</a>.</p>
</div>
<div id="calculate-actual-values" class="section level3">
<h3>Calculate actual values</h3>
<p>Before getting into any bootstrapping analyses, you must calculate the actual Fst and Ht values.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">fsts&lt;-<span class="kw">calc.actual.fst</span>(gpop)
<span class="kw">head</span>(fsts)</code></pre></div>
<pre><code>##   Locus       Ht                 Fst
## 1  loc0 0.410112  0.0139279026217228
## 2  loc1 0.463008 0.00114036906489731
## 3  loc2 0.488448  0.0426821278825995
## 4  loc3 0.488448  0.0174593815513626
## 5  loc4 0.426272  0.0301028451317469
## 6  loc5 0.198912  0.0600868725868724</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#Plot the actual values to see what your distribution looks like</span>
<span class="kw">par</span>(<span class="dt">mar=</span><span class="kw">c</span>(<span class="dv">4</span>,<span class="dv">4</span>,<span class="dv">1</span>,<span class="dv">1</span>))
<span class="kw">plot</span>(fsts$Ht, fsts$Fst,<span class="dt">xlab=</span><span class="st">&quot;Ht&quot;</span>,<span class="dt">ylab=</span><span class="st">&quot;Fst&quot;</span>,<span class="dt">pch=</span><span class="dv">19</span>)</code></pre></div>
<p><img src="data:image/png;base64,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" alt /><!-- --></p>
<p>Since this distribution is not highly skewed, it should be fine for a bootstrap analysis. If you only have two demes (and your graph is skewed highly to the right), you might consider using alternative approaches to identifying outliers (e.g. BayeScan, BayEnv, PCAdapt).</p>
</div>
</div>
<div id="bootstrapping" class="section level2">
<h2>Bootstrapping</h2>
<p>The <code>boot.out</code> function conducts a single bootstrap run. We recommend running at least 10 bootstrap replicates. The bootstrap module is relatively slow, so if you want to verify that your data are correctly formatted and everything is going according to plan you can run it with a single replicate.</p>
<div id="testing-it-out" class="section level3">
<h3>Testing it out</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">boot.test&lt;-<span class="kw">fst.boot</span>(gpop)</code></pre></div>
<pre><code>## [1] &quot;Bootstrapping done. Now Calculating CIs&quot;</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">str</span>(boot.test)</code></pre></div>
<pre><code>## List of 3
##  $ Fsts:'data.frame':    2000 obs. of  2 variables:
##   ..$ Ht : num [1:2000] 0.0392 0.043 0.043 0.0582 0.0582 ...
##   ..$ Fst: num [1:2000] 0.00816 0.00446 0.0026 0.01512 0.01512 ...
##  $ Bins:'data.frame':    22 obs. of  2 variables:
##   ..$ newbreaks: num [1:22] -0.03 0.05 0.07 0.09 0.11 0.13 0.15 0.17 0.19 0.21 ...
##   ..$ breaks   : num [1:22] 0.08 0.1 0.12 0.14 0.16 0.18 0.2 0.22 0.24 0.26 ...
##  $     :List of 1
##   ..$ CI0.95: num [1:22, 1:2] 0.0026 0.00247 0.00247 0.00589 0.00438 ...
##   .. ..- attr(*, &quot;dimnames&quot;)=List of 2
##   .. .. ..$ : chr [1:22] &quot;0.08&quot; &quot;0.1&quot; &quot;0.12&quot; &quot;0.14&quot; ...
##   .. .. ..$ : chr [1:2] &quot;Low&quot; &quot;Upp&quot;</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">head</span>(boot.test[[<span class="dv">3</span>]][[<span class="dv">1</span>]])</code></pre></div>
<pre><code>##              Low        Upp
## 0.08 0.002602714 0.02505165
## 0.1  0.002472423 0.04712198
## 0.12 0.002472423 0.05602837
## 0.14 0.005894737 0.05898618
## 0.16 0.004376368 0.05898618
## 0.18 0.001480975 0.06398046</code></pre>
<p>From the results of <code>str(boot.test)</code>, you can see that <code>fst.boot()</code> returns a list of three data frames: one with the bootstrapped Ht and Fst values, one with the bins from bootstrapping, and one with the Ht and Fst values for the upper and lower confidence intervals.</p>
<p>If you want to visualize these results, you can use <code>plotting.cis</code>. Plotting.cis requires the raw datapoints (<code>fsts</code>) and either a list with the confidence intervals or a list of multiple bootstrap replicates. Since we only ran a single bootstrap replicate in this case, we’ll give <code>plotting.cis</code> a list.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#plot the results</span>
ci.list&lt;-<span class="kw">ci.means</span>(boot.test[[<span class="dv">3</span>]])
<span class="kw">par</span>(<span class="dt">mar=</span><span class="kw">c</span>(<span class="dv">4</span>,<span class="dv">4</span>,<span class="dv">1</span>,<span class="dv">1</span>))
<span class="kw">plotting.cis</span>(<span class="dt">df=</span>fsts,<span class="dt">ci.list=</span>ci.list,<span class="dt">make.file=</span>F)</code></pre></div>
<p><img src="data:image/png;base64,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" alt /><!-- --></p>
<p>Clearly, these confidence intervals are not ideally smoothed (since they only represent a single replicate), but you can see that they generally follow the shape of the distribution.</p>
<p>The function <code>smooth.cis</code> can also be used to smooth the confidence intervals. All this does is remove some of the intermediate points from the confidence intervals.</p>
<p><strong>fhetboot</strong> also contains the option for calculating p-values. To calculate p-values, run <code>p.boot</code> on the bootstrapping output. For this function to work, you must have run <code>fst.boot</code> more than once. It takes the data.frame of actual Fst values and either the bootstrapping output or the output from running <code>fst.boot.means</code>.</p>
</div>
<div id="running-the-actual-analysis" class="section level3">
<h3>Running the actual analysis</h3>
<p>The simplest way to run the analysis is to use the <code>replicate</code> function. I recommend running about 10 bootstrap replicates. I tested 10, 100, and 1000 replicates and they all yielded qualitatively similar results, so since the <code>fst.boot</code> function is rather slow you can get away with using a minimum of 10 replicates. You might want to test out different numbers of replicates for yourself, if you want to make sure you’re accurately representing your data.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">boot.out&lt;-<span class="kw">as.data.frame</span>(<span class="kw">t</span>(<span class="kw">replicate</span>(<span class="dv">10</span>, <span class="kw">fst.boot</span>(gpop))))</code></pre></div>
<pre><code>## [1] &quot;Bootstrapping done. Now Calculating CIs&quot;
## [1] &quot;Bootstrapping done. Now Calculating CIs&quot;
## [1] &quot;Bootstrapping done. Now Calculating CIs&quot;
## [1] &quot;Bootstrapping done. Now Calculating CIs&quot;
## [1] &quot;Bootstrapping done. Now Calculating CIs&quot;
## [1] &quot;Bootstrapping done. Now Calculating CIs&quot;
## [1] &quot;Bootstrapping done. Now Calculating CIs&quot;
## [1] &quot;Bootstrapping done. Now Calculating CIs&quot;
## [1] &quot;Bootstrapping done. Now Calculating CIs&quot;
## [1] &quot;Bootstrapping done. Now Calculating CIs&quot;</code></pre>
<p><code>boot.out</code> is a data.frame with three elements: the bootstrapped values (Fsts), the bins used in the bootstrapping (Bins), and a list of the upper and lower confidence intervals (V3). Each of these elements is a list of data.frames, with one data.frame per bootstrap replicate. Use <code>str</code> to visualize the output if you’re confused.</p>
<p>Now we want to generate a plot with the confidence intervals. Again, <code>plotting.cis</code> will do the trick. We can also use the <code>find.outliers</code> function to pull out a data.frame containing the loci that lie outside of the confidence intervals.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">par</span>(<span class="dt">mar=</span><span class="kw">c</span>(<span class="dv">4</span>,<span class="dv">4</span>,<span class="dv">1</span>,<span class="dv">1</span>))
<span class="kw">plotting.cis</span>(<span class="dt">df=</span>fsts,<span class="dt">boot.out=</span>boot.out,<span class="dt">make.file=</span>F)</code></pre></div>
<p><img src="data:image/png;base64,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" alt /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">outliers&lt;-<span class="kw">find.outliers</span>(fsts,<span class="dt">boot.out=</span>boot.out)
<span class="kw">head</span>(outliers)<span class="co">#the CI outliers</span></code></pre></div>
<pre><code>##        Locus                 Ht                 Fst
## 863   loc862 0.0731120000000001  0.0387350913666707
## 1706 loc1705           0.043032 0.00260271425915342
## 1939 loc1938             0.0768             0.03125
## 228   loc227 0.0804720000000001  0.0471219803161355
## 750   loc749           0.084128 0.00247242297451453
## 1542 loc1541 0.0804720000000001  0.0491102495277865</code></pre>
</div>
</div>
<div id="customizing-the-figures" class="section level2">
<h2>Customizing the Figures</h2>
<p>The default <code>plotting.cis()</code> output may not be ideal for publication. Luckily, the function <code>plotting.cis()</code> has several built-in options for customizing the plot.</p>
<div id="the-data-you-use" class="section level3">
<h3>The data you use</h3>
<p>As demonstrated in the two cases above, <code>plotting.cis()</code> requires the original data and one of two things with the confidence intervals.<br />
 - The results from multiple bootstrap replicates (as generated by the above example), and it then calculates the mean confidence intervals from those. This is specified by <code>plotting.cis(boot.out=&lt;name&gt;)</code>.<br />
 - A <code>ci.list</code>, which is actually a data.frame with Ht values as row names and two columns: low, and upp. These header names are requried for it to work.</p>
<p>One of these two things is required or <code>plotting.cis()</code> will fail.</p>
<p>If your actual data (<code>df=&lt;name&gt;</code>, or <code>fsts</code> in the above examples) have different column names, you can specify those using <code>plotting.cis(Ht.name=&lt;name&gt;)</code> and <code>plotting.cis(Fst.name=&lt;name&gt;)</code>. Otherwise, the defaults are <code>plotting.cis(Ht.name=&quot;Ht&quot;,Fst.name=&quot;Fst&quot;)</code>.</p>
</div>
<div id="the-look-of-the-graph" class="section level3">
<h3>The look of the graph</h3>
<p>Several aspects of the graph can be controlled through <code>plotting.cis()</code>: the color of the confidence interval lines and the shape of the points. These are controlled by <code>ci.col</code> and <code>pt.pch</code>.<br />
The defaults are: <code>plotting.cis(ci.col=&quot;red&quot;, pt.pch=1)</code>.<br />
The default CI color is red and the defualt point shape is open circles (<code>pt.pch=1</code>). You can also color-code some loci (for instance ones with significant p-values) using <code>sig.col</code>. The default setting for <code>sig.col</code> is to be identical to <code>ci.col</code>. The default setting is to smooth the confidence intervals with the settings <code>smooth.ci=TRUE, smoothing.rate=0.025</code>.</p>
</div>
<div id="saving-the-graph-to-a-file" class="section level3">
<h3>Saving the graph to a file</h3>
<p>In the above examples, you may have noticed that <code>plotting.cis()</code> always contained the command <code>make.file=F</code>. This command allows you to automatically save the graph to a file or to print it to the default device in R. If <code>make.file=TRUE</code>, then the function generates a *.png file. The default file name is “OutlierLoci.png”, but this can be changed using <code>file.name</code>. If you choose to designate a file.name, it must contain the “.png” extension. For example:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plotting.cis</span>(<span class="dt">df=</span>fsts,<span class="dt">boot.out=</span>boot.out,<span class="dt">make.file=</span>T,<span class="dt">file.name=</span><span class="st">&quot;ExampleOutliers.png&quot;</span>)</code></pre></div>
</div>
</div>
<div id="other-functions" class="section level2">
<h2>Other Functions</h2>
<p>I just want to take a moment to discuss what the other functions in <strong>fhetboot</strong> do and some other ways to use the proram.</p>
<div id="saving-the-data-and-plotting-it-yourself." class="section level3">
<h3>Saving the data and plotting it yourself.</h3>
<p>Although <code>plotting.cis</code> can be a useful tool, it is possible to save your confidence intervals and generate your own plots. First, you use the function <code>ci.means()</code> to calculate the mean confidence intervals across all of the bootstrap replicates, and then you can generate a plot and add the confidence intervals using <code>points()</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#calculate means</span>
boot.out.ci&lt;-<span class="kw">ci.means</span>(boot.out[[<span class="dv">3</span>]])

<span class="co">#create a data.frame of confidence intervals</span>
cis&lt;-<span class="kw">as.data.frame</span>(<span class="kw">do.call</span>(cbind,boot.out.ci))
<span class="kw">colnames</span>(cis)&lt;-<span class="kw">c</span>(<span class="st">&quot;low&quot;</span>,<span class="st">&quot;upp&quot;</span>)
cis$Ht&lt;-<span class="kw">as.numeric</span>(<span class="kw">rownames</span>(cis))

<span class="co">#plot</span>
<span class="kw">par</span>(<span class="dt">mar=</span><span class="kw">c</span>(<span class="dv">4</span>,<span class="dv">4</span>,<span class="dv">1</span>,<span class="dv">1</span>))
<span class="kw">plot</span>(fsts$Ht, fsts$Fst,<span class="dt">pch=</span><span class="dv">19</span>,<span class="dt">xlab=</span><span class="st">&quot;Ht&quot;</span>,<span class="dt">ylab=</span><span class="st">&quot;Fst&quot;</span>)
<span class="kw">points</span>(cis$Ht,cis$low,<span class="dt">type=</span><span class="st">&quot;l&quot;</span>,<span class="dt">col=</span><span class="st">&quot;red&quot;</span>)
<span class="kw">points</span>(cis$Ht,cis$upp,<span class="dt">type=</span><span class="st">&quot;l&quot;</span>,<span class="dt">col=</span><span class="st">&quot;red&quot;</span>)</code></pre></div>
<p><img src="data:image/png;base64,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" alt /><!-- --></p>
</div>
<div id="look-at-the-distribution-of-allele-frequencies" class="section level3">
<h3>Look at the distribution of allele frequencies</h3>
<p>The analyses in <strong>fhetboot</strong> use the function <code>calc.allele.freq</code> to calculate allele frequencies. If you’re interested in examining the allele frequency distribution in your dataset, you can use this function on your actual data.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">af.actual&lt;-<span class="kw">apply</span>(gpop[,<span class="dv">3</span>:<span class="kw">ncol</span>(gpop)],<span class="dv">2</span>,calc.allele.freq)

<span class="co">#extract the minimum allele frequency for each locus</span>
min.af&lt;-<span class="kw">unlist</span>(<span class="kw">lapply</span>(af.actual,min))
<span class="kw">par</span>(<span class="dt">mar=</span><span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>))
<span class="kw">hist</span>(min.af)</code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAXVBMVEUAAAAAADoAAGYAOjoAOpAAZrY6AAA6ADo6AGY6OgA6OpA6kNtmAABmtv+QOgCQOjqQZgCQtpCQ2/+2ZgC2Zma2/7a2///bkDrb2//b////tmb/25D//7b//9v///+Su1IFAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAIG0lEQVR4nO2da3viNhCFnW1g20LSNm7rxoD//8+sLpYtgUZHNjg41jkfdsEcxtJrXYY8Y6g6Kqnq2Q1YuwgIiICACAiIgIAICIiAgAgIiICACAiIgIAICGgeoMt79fpp/98NTzz9/e/9LQtVV5U6Vaots96MtQSg8/HHowG1qovVIdmWWW/GegCgG9XVwwE11cvHc978uBHU6OukH+gBbRCd9uOVUwdfPgw51dy/9rrJ5mXd9POx2umr/KZj+H0ZApiQ9pUbsz19Y8L77x7Ce29+JiDDx4BxgPoj2qgsupG/jYdfP1v7smq56rOncfSNAUJAoTk4/QhiDP8kQE49IH1hTasOboqpK2gbfjDHd+ZSWkA9s50xHUyfD90wLNxq4QcYZ8mNeQBkYx+GFrrwT5piV4BUU4ZLbwH1K1FtB5V+rPpmO/Hm4jQmgDquumj/tV3ywnRuXo6AQvMA6M0A8ddEG34dgPojh6Fnbhbq1rnHQV9dDANo1/X/joD8ACGg0DyuQe5wF4ZfySLt1oa3noNrq5oMb+6xD8h0wL4SB+QHmA7IC78SQN24j2WNIEsiAei+EeSFXwmgyx8fXbDiyGuQaW7rFo2DAEheg3IAeeHXAchuOX5j5V3MjSC7ckkjSN7FAKCxPTb8OgC5REQ3pQ3yoF13nQeNa1Bqke78AJMBeeFXAshmrnar71Nac6Tf0s3oudnFXj4adUgC5AWYDMgL/wxAM1XDz93r09cAqs1CcpXGfQ99DaD2+pPS99EXTTGbRn6/CcY/uUIREBABAREQEAEBERAQAQEREBABAREQEAEBERAQAQEREBABAT0VUBXRM9sT03MBRQ6tDdraTh5rz9ra+NSTlwsoc+7kAvqymXh/1GjP85qfC2g+2/v1AEB5xx5r+7r1fUuAMt86TQQEREBABARkI7hqmjkV8iUAalxNTjvjloYCAF3ex6Ku6fUFBQA6H4fK7nb6JCsAEEdQQv0a1A8hrkFCBFcmP6fCqQhAj45AQCDC5gAxURTFRBGI2zxQMlHM+sNTAYAyRlDZgDISxcIB4USxdED32AgI2AoCdNq/5dgyXtoYIP/bHoRcumxAbvPiCBIjnI/2rlMCEiPU5vtqCEiOoD6wElAywmn/CwElI1zeKwKaG4GA5tsICNgICNgICNgICNgICNgICNgICNgICNgICNgICNgICNgICNgICNgICNgICNiKAAQrzAoHhCvMygbE+qCEdISMWxHKBsQRlFC/BrHCTJKNwAozUcyDgAgIiIkiEBNFIG7zQMlEkbcicARBMVEEYqIIxDwIiICAvAht4odBSgekf1rm9Punv+Fnn6gEQLX+WTkzerjNxyKYcXP6aX43jn9RjEQ4H3X2c/mv4wgSIjRu3FhU005UAqCusdtXK5balw7oHhsBARsBARsBARsBARsBARsBARsBARsBARsBARsBARsBARsBARsBARsBARsBARsBARsBAVsRgFhhJspEYIWZLB2B9UEJ6Qi8FSGhiSPowT8cNtv25WtQboXZ4j1fJ6D8CrNvB+ju32SbmAd9O0B5toQICGhiolgooPxEsUxAU7b5h7bruwCacCtCmYA4ghIqL1GctYttN1HMsyXEPAiIgICsvVHTyyxDDfhzR6GAdJHr+bjrCChut9v85V0t0QQUs7tEsX79JKCYfUgU6x0BRe0Oi0qHCChqd6n05Z2A5tkJKNNGQMBGQMBGQMBGQMBGQMBGQMBGQMBGQMBGQMBGQMBGQMBGQMBGQMBGQMBGQMBGQMBWKiBWmIkydlaYydJ21gclpO0TbkUoExBHUEL9GsQKM0nWzgozUcyDgAgIiIkiEBNFIG7zQMlEkbcicARBMVEEYqIIxDwIiICACAiIgIBsHjTmO/yDWcwulkffRC0UkCK0y7GVCyjxdf9h1GIB5doICNgICNgICNgICNgICNgICNgICNgICNgICNgICNgICNgICNgICNgICNgICNgICNgICNgICNgICNgICNgICNgICNgICNgICNgICNgICNgICNhKBcRbEUQZO29FkKXtLCRPSNun3IqwAU0HlDGCylW/BqFbEcqVHXDwVoRyNXFGlicCAiIgIAICmpoVbEDLAirGtqx9A7Zl7RuwLWvfgG1Z+wZsy9o3YFvWvgHbsvYN2Ja1b8C2rH0Dtpn28kRAQAQEREBABAREQEAEBERAQAQEREBABAREQEAEBJQHqK2ql4/oE9FmqvritSLXAep4zURgO+2rKv4lUIGtUSeVvgnp9OtQ+yR34UZZgFoVrXURgyei7fKuHjTRPl0HaONFJeFJleV8hNEa/UQgdD4OxWFyF26VA8gWWNW72yey7bTXzYz9+Ph1gPMxCihyUhjNftNYrG1m0Li3y12IKAdQ0Fm555FXYpfp2ta8/hkDFJ70p3S5A1sCUFsdhvJCuQsRZQEyzWv9tsZ+fyPySo1t6ml0DQps7Y9/jvEVLYyWmmLBKYUuRJQDyI6DfjQET2SbPRLrU2jTwz0KKLA1enpEv6rv6qSp1XcgInchoiUBteIaPdp01WgGoBfpmofR9Ig97YU6y+UAzZxiQkXobTQ8xex6YdeOVLTk4rLcFJu3SDdCFhTYmr5mJ9Jz32Y7E1uqQ1tyaCy3SM/Z5sfS4rRNKzqCApstdY9d80huIQ2N4fjDt/k5iaK4EkQCxDPpMANUFq/eXbLlrUEPTxTNTNDx7D7SiDuFZ+vnTtQYROvEjxqBrRU/uAS2WrT1gFAXbsQPq0AEBERAQP8D/jHk0pwmU6gAAAAASUVORK5CYII=" alt /><!-- --></p>
</div>
</div>
<div id="conclusion" class="section level2">
<h2>Conclusion</h2>
<p>Hopefully this package will be a useful tool for population geneticists and molecular ecologists. It’s important to consider the assumptions of the tests you use as well as remembering that statistics should be used to describe your dataset. Use your common sense about when to use different methods and how to implement them. Good luck!</p>
<hr />
<p><em>If you run into any problems, find any bugs, or have other comments on fhetboot please contact me: <a href="mailto:spflanagan.phd@gmail.com">spflanagan.phd@gmail.com</a>.</em></p>
<hr />
</div>



<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
