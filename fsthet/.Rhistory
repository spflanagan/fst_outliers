library(car)
?sweep
myscores<-c("Good","Excellent","Good","Good","Very Good","Very Good","Good/Very Good","Fair","Good","Good",
"Very Good/Excellent","Very Good/Excellent","Good/Very Good","Good","Very Good","Good",
"Very Good/Excellent","Poor","Fair")
myscores["Poor"]<-1
myscores["Fair"]<-2
myscores["Good"]<-3
myscores["Good/Very Good"]<-3.5
myscores["Very Good"]<-4
myscores["Very Good/Excellent"]<-4.5
myscores["Excellent"]<-5
hist(as.numeric(myscores))
myscores
myscores<-c("Good","Excellent","Good","Good","Very Good","Very Good","Good/Very Good","Fair","Good","Good",
"Very Good/Excellent","Very Good/Excellent","Good/Very Good","Good","Very Good","Good",
"Very Good/Excellent","Poor","Fair")
myscores["Poor"]
myscores[myscores %in% "Poor"]
myscores[myscores %in% "Poor"]
myscores[myscores %in% "Poor"]<-1
myscores
myscores[myscores %in% "Poor"]<-1
myscores[myscores %in% "Fair"]<-2
myscores[myscores %in% "Good"]<-3
myscores[myscores %in% "Good/Very Good"]<-3.5
myscores[myscores %in% "Very Good"]<-4
myscores[myscores %in% "Very Good/Excellent"]<-4.5
myscores[myscores %in% "Excellent"]<-5
myscores
plot(as.numeric(myscores))
hist(as.numeric(myscores))
library(gwscaR)
vcf.file<-system.file("extdata", "example.vcf.txt",package = "gwscaR")
vcf<-parse.vcf(vcf.file)
function (..., sep = " ", collapse = NULL)
vcf$SNP<-paste(vcf$`#CHROM`,vcf$POS,sep=".")
vcf$SNP<-paste(vcf$`#CHROM`,vcf$POS,sep=".")
head(vcf$SNP)
locus.info<-c("#CHROM","POS","ID","REF","ALT","QUAL","FILTER","INFO","FORMAT","SNP")
grp1<-grep("FEM",colnames(vcf),value=T)
grp2<-c(grep("PRM",colnames(vcf),value=T),grep("NPM",colnames(vcf),value=T))
sel<-do.call(rbind,apply(vcf,1,fst.one.vcf,group1=c(locus.info,grp1),group2=c(locus.info,grp2),
cov.thresh=0.5,maf=0.05))
sel<-do.call(rbind,apply(vcf,1,fst.one.vcf,group1=c(locus.info,grp1),group2=c(locus.info,grp2),
cov.thresh=0.5,maf=0.05))
sel<-sel[!is.na(sel$Fst),] #Remove the ones that weren't polymorphic
head(sel)
(0.260355+0.21875)/2
vcf[7,1:10]
vcf.row<-vcf[7,]
hs1<-hs2<-hs<-ht<-0
freqall<-gt1<-gt2<-NULL
gt1<-unlist(lapply(vcf.row[group1],function(x){
c<-strsplit(as.character(x),split=":")[[1]][1]
return(c)
}))
num.ind1<-length(gt1[gt1 %in% c("0/0","1/0","0/1","1/1","./.")])
gt1<-gt1[gt1 %in% c("0/0","1/0","0/1","1/1")]
gt1[gt1=="1/0"]<-"0/1"
gt1<-gsub(pattern = "0",replacement = vcf.row["REF"],gt1)
gt1<-gsub(pattern = "1",replacement = vcf.row["ALT"],gt1)
group1<-grp1
group1<-c(locus.info,grp1)
group2<-c(locus.info,grp2)
hs1<-hs2<-hs<-ht<-0
freqall<-gt1<-gt2<-NULL
gt1<-unlist(lapply(vcf.row[group1],function(x){
c<-strsplit(as.character(x),split=":")[[1]][1]
return(c)
}))
num.ind1<-length(gt1[gt1 %in% c("0/0","1/0","0/1","1/1","./.")])
gt1<-gt1[gt1 %in% c("0/0","1/0","0/1","1/1")]
gt1[gt1=="1/0"]<-"0/1"
gt1<-gsub(pattern = "0",replacement = vcf.row["REF"],gt1)
gt1<-gsub(pattern = "1",replacement = vcf.row["ALT"],gt1)
al1<-unlist(strsplit(as.character(gt1),split = "/"))
gt2<-unlist(lapply(vcf.row[group2],function(x){
c<-strsplit(as.character(x),split=":")[[1]][1]
return(c)
}))
num.ind2<-length(gt2[gt2 %in% c("0/0","1/0","0/1","1/1","./.")])
gt2<-gt2[gt2 %in% c("0/0","1/0","0/1","1/1")]
gt2[gt2=="1/0"]<-"0/1"
gt2<-gsub(pattern = "0",replacement = vcf.row["REF"],gt2)
gt2<-gsub(pattern = "1",replacement = vcf.row["ALT"],gt2)
al1
al2
al2<-unlist(strsplit(as.character(gt2),split="/"))
al2
freq1<-summary(factor(al1))/sum(summary(factor(al1)))
freq2<-summary(factor(al2))/sum(summary(factor(al2)))
freqall<-mean(c(freq1[1],freq2[1]))
freq1
freq1
freq2
freqall
hs1<-2*freq1[1]*freq1[2]
hs2<-2*freq2[1]*freq2[2]
#hs<-((hs1*length(gt1))+(hs2*length(gt2)))/(length(gt1)+length(gt2)) #weighted avg
hs<-mean(c(hs1,hs2))
ht<-2*freqall*(1-freqall)
fst<-(ht-hs)/ht
hs
ht
sample(1,22,115)
?sample
sample(1:22,115)
sample(seq(1,22),115)
sample(seq(1,22),115,replace=T)
bayes.test<-data.frame(Dataset=c(rep("SCA",55),rep("FWSW",60),rep("butterflies",120),
Species=c(rep("S.scovelli",115),rep("L.melissa",120)),
SelectionType=c(rep("SexualSelection",15),rep("MFViabiliatySelection",40),
rep("LocalAdaptation",60),rep("LocalAdaptation",120)),
Habitat=c(rep("Marine",115),rep("Alpine",120)),
Chrom=c(sample(seq(1,22),115,replace=T),sample(seq(1,22),120,replace=T)),
Pos=c(sample(seq(1,58930209),235)),
type=c(sample(c("5UTR","3UTR","exon","intron","contig"),235,replace = T)),
stringsAsFactors=FALSE)
)
bayes.test<-data.frame(Dataset=c(rep("SCA",55),rep("FWSW",60),rep("butterflies",120)),
Species=c(rep("S.scovelli",115),rep("L.melissa",120)),
SelectionType=c(rep("SexualSelection",15),rep("MFViabiliatySelection",40),
rep("LocalAdaptation",60),rep("LocalAdaptation",120)),
Habitat=c(rep("Marine",115),rep("Alpine",120)),
Chrom=c(sample(seq(1,22),115,replace=T),sample(seq(1,22),120,replace=T)),
Pos=c(sample(seq(1,58930209),235)),
type=c(sample(c("5UTR","3UTR","exon","intron","contig"),235,replace = T)),
stringsAsFactors=FALSE)
head(bayes.test)
gene.list<-c("657532792:PREDICTED: cytoplasmic dynein 1 heavy chain 1[Stegastes partitus]",
"835882179 : PREDICTED : cytoplasmic dynein 2 heavy chain 1[Maylandia zebra]",
"658901969 : PREDICTED : dynein heavy chain 2, axonemal[Poecilia reticulata]",
"657541441 : PREDICTED : dynein heavy chain 9, axonemal[Stegastes partitus]",
"808857365 : Dynein heavy chain 11 axonemal[Larimichthys crocea]",
"734632573 : PREDICTED : dynein heavy chain 8, axonemal[Larimichthys crocea]")
lapply(gene.list, strsplit,"\s")
lapply(gene.list, strsplit,"\\s")
lapply(gene.list,gsub,":","")
gene.list
lapply(gene.list,gsub,pattern=":",replacemnt="")
?gsub
lapply(gene.list,gsub,pattern=":",replacement="")
al.gene.list<-lapply(gene.list,gsub,pattern=":",replacement="")
lapply(al.gene.list, strsplit,"\\s")
words<-unlist(lapply(al.gene.list, strsplit,"\\s"))
words
words<-lapply(al.gene.list, strsplit,"\\s")
words
str(words)
words<-lapply(unlist,lapply(al.gene.list, strsplit,"\\s"))
words<-lapply(unlist,lapply,x=al.gene.list, strsplit,"\\s")
lapply(words,unlist)
words<-lapply(words,unlist)
words
words<-lapply(words,unlist)
words
unique(words)
levels(words)
length(words)
i<-1
this.word<-unique(words[i])
this.word
lapply(words, unique)
words[!i]
words[i]
words
words[words[i] %in% words[2]]
wordss[words[[i]]]
words[words[[i]]]
wordss
words
this.word<-unique(words[[i]])
this.word
words[words[i] != ""]
?intersect
?Reduce
Reduce(intersect,words)
tolower(words)
new.words<-tolower(words)
new.words
new.words<-lapply(words, tolower)
new.words
Reduce(intersect,new.words)
citation("lattice")
genotypes<-sample(c("0101","0102","0202"),50,replace=TRUE)
setwd("GitHub/fsthet_analysis/fsthet/data/")
list.files()
setwd("GitHub/fsthet_analysis/fsthet/extdata/")
setwd("../extdata/")
list.files
list.files()
gfile<-system.file("extdata", "example.genepop.txt",package = 'fsthet')
dim(gfile)
head(gfile)
gpop<-my.read.genepop(gfile)
gpop<-my.read.genepop("example.genepop.txt")
setwd("../../../")
getwd()
setwd("fsthet_analysis/")
source("fsthet/")
setwd("fsthet/")
source("R/fsthet.R")
gpop<-my.read.genepop("example.genepop.txt")
gpop<-my.read.genepop("extdata/example.genepop.txt")
dim(gpop)
head(gpop)
dim(gpop)
gpop[1:10,1:10]
gpop<-data.frame(popinfo=c(rep("POP 1", 20),rep("POP 2", 20)),ind.names=c(1:20,1:20),
loc0=sample(c("0101","0102","0202"),40,replace=TRUE))
dim(gpop)
head(gpop)
fsts<-calc.actual.fst(gpop)
fsts
quant.out<-fst.boot(gpop, bootstrap = FALSE)
quant.list<-ci.means(quant.out[[3]])
theta1<-calc.theta(gpop, 3)
loc0=sample(c("0101","0102","0202"),40,replace=TRUE),
loc1=sample(c("0101","0102","0202"),40,replace=TRUE))
quant.out<-fst.boot(gpop, bootstrap = FALSE)
gpop<-data.frame(popinfo=c(rep("POP 1", 20),rep("POP 2", 20)),ind.names=c(1:20,1:20),
loc0=sample(c("0101","0102","0202"),40,replace=TRUE),
loc1=sample(c("0101","0102","0202"),40,replace=TRUE))
quant.out<-fst.boot(gpop, bootstrap = FALSE)
quant.list<-ci.means(quant.out[[3]])
quant.out
out.dat<-fhetboot(gpop,fst.choice="fst",alpha=0.05,nreps=10)
head(gpop)
fsts<-calc.actual.fst(gpop)
boot.out<-as.data.frame(t(replicate(10, fst.boot(gpop))))
outliers<-find.outliers(fsts,boot.out)
gpop<-data.frame(popinfo=c(rep("POP 1", 20),rep("POP 2", 20)),ind.names=c(1:20,1:20),
loc0=sample(c("0101","0102","0202"),40,replace=TRUE),
loc1=sample(c("0101","0102","0202"),40,replace=TRUE))
var1<-var.fst(gpop,3)
var1
fsts<-calc.actual.fst(gpop)
fsts
cis<-find.quantiles(bins = bins$bins,bin.fst = bins$bin.fst)
as.data.frame(t(replicate(10,fst.boot(gpop))))
nloci<-(ncol(gpop)-2)
boot.out<-as.data.frame(t(replicate(nloci, fst.boot.onecol(gpop))))
outliers<-find.outliers(fsts,boot.out)
quant.out<-as.data.frame(t(replicate(1, fst.boot(gpop,bootstrap=FALSE))))
quant.out
fsthet(gpop)
gpop<-data.frame(popinfo=c(rep("POP 1", 20),rep("POP 2", 20)),ind.names=c(1:20,1:20),
loc0=sample(c("0101","0102","0202"),40,replace=TRUE),
loc1=sample(c("0101","0102","0202"),40,replace=TRUE))
fsts<-calc.actual.fst(gpop)
nloci<-(ncol(gpop)-2)
boot.out<-as.data.frame(t(replicate(nloci, fst.boot.onecol(gpop))))
make.bins(boot.out,25)
bins<-make.bins(fsts)
cis<-find.quantiles(bins = bins$bins,bin.fst = bins$bin.fst)
cis
