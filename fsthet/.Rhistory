fsts<-calc.actual.fst(gpop)
head(fsts)
plot(fsts$Ht, fsts$Fst,xlab="Ht",ylab="Fst",pch=19)
library(fsthet)
fst.options.print()
library(fsthet)
library(fsthet)
fst.options.print()
f1<-calc.actual.fst(gpop,"fst")
f2<-calc.actual.fst(gpop,"var")
f3<-calc.actual.fst(gpop,"theta")
f4<-calc.actual.fst(gpop,"betahat")
gpop<-my.read.genepop("Nm1.d2.s20.ds0.genepop")#"Nm0.1.d2.s2.genepop.step.loci"
setwd("~/Projects/fst_outliers/results/numerical_analysis_selection/")
gpop<-my.read.genepop("Nm1.d2.s20.ds0.genepop")#"Nm0.1.d2.s2.genepop.step.loci"
f1<-calc.actual.fst(gpop,"fst")
f2<-calc.actual.fst(gpop,"var")
f3<-calc.actual.fst(gpop,"theta")
f4<-calc.actual.fst(gpop,"betahat")
library(fsthet)
setwd("~/Projects/fst_outliers/results/numerical_analysis_selection/")
gpop<-my.read.genepop("Nm1.d2.s20.ds0.genepop")#"Nm0.1.d2.s2.genepop.step.loci"
f1<-calc.actual.fst(gpop,"fst")
f2<-calc.actual.fst(gpop,"var")
f3<-calc.actual.fst(gpop,"theta")
f4<-calc.actual.fst(gpop,"betahat")
los<-read.delim("Nm1.d2.s20.ds0.genepop.step.loci") #the lositan data
plot(los$Het,los$Fst,ylim=c(0,1),pch=19)
head(f1)
head(f2)
head(f3)
head(f4)
points(f1$Ht,f1$Fst,pch=1,col="orchid")
points(f2$Ht,f2$Fst,pch=2,col="cornflowerblue")
points(f3$Ht,f3$Fst,pch=3,col="forestgreen")
points(f4$Ht,f4$Fst,pch=4,col="goldenrod")
f<-calc.actual.fst(gpop,"wcc") #run with corrected weir & cockerham
f.n<-calc.actual.fst(gpop,"wright") #run with nei's formulation of wright's fst
points(f$Ht,f$Fst,col="orchid",pch=5)
points(f.n$Ht,f.n$Fst,col="forestgreen",pch=6)
adams<-read.delim("~/Desktop/Fdistcheckerresults.xls")
head(adams)
plot(adams$Ht,adams$Fst)
gpop<-my.read.genepop("~/Desktop/genepopdata.txt")
plot(adams$Ht,adams$LosFst)
library(fsthet)
f1<-calc.actual.fst(gpop,"fst")
head(f1)
plot(f1$Ht,f1$Fst)
0.002*1000
adams<-read.delim("~/Desktop/Fdistcheckerresults.xls")
plot(adams$Ht,adams$Fst)
los<-read.delim("Nm1.d2.s20.ds0.genepop.step.loci") #the lositan data
plot(los$Het,los$Fst,ylim=c(0,1),pch=19)
plot(adams$Ht,adams$Fst)
plot(los$Het,los$Fst,ylim=c(0,1),pch=19)
points(adams$Ht,adams$Fst,col="blue")
points(adams$Ht,adams$LosFst,col="purple")
points(adams$HB,adams$theta,col="purple")
points(adams$HB,adams$betahat,col="green")
plot(los$Het,los$Fst,ylim=c(0,1),pch=19)
points(adams$HB,adams$betahat,col="green")
head(adams)
points(adams$HB,adams$b.hat,col="green")
points(adams$popHt,adams$popFst,col="green")
points(adams$popHt,adams$popFst,col="goldenrod")
points(adams$Ht,adams$theta,col="grey")
gpop[1:10,1:10]
df<-split(gpop[,4],gpop[,1])
str(df)
af<-do.call("rbind",lapply(df.split,calc.allele.freq))
df.split<-split(gpop[,4],gpop[,1])
af<-do.call("rbind",lapply(df.split,calc.allele.freq))
af
hexp<-apply(af,1,calc.exp.het)
hexp
af[,1]*af[,2]
af*af
af
sqaf<-af*af
sqaf
1-sum(sqaf)
af[,1]*af[,1]
1-sum(af[,1]*af[,1])
2*af[1]*(1-af[1])
calc.exp.het
hexp<-apply(af,1,calc.exp.het)
hexp
pbar<-mean(af[,1])
pbar
ht<-2*pbar*(1-pbar)
ht
fst<-1-(hs/ht)
hs<-mean(hexp)
fst<-1-(hs/ht)
fst
points(hs,fst,col="red")
head(los)
points(los$Het[2],los$Fst[2],col="purple")
points(los$Het[2],los[2,3],col="purple")
plot(los$Het,los$Fst,ylim=c(0,1),pch=19)
head(df.split)
genotypes<-df.split$`POP 1`
genotypes
obs.gen<-summary(as.factor(genotypes))
obs.gen
obs.gen<-obs.gen[names(obs.gen) != "000000" & names(obs.gen)
!= "0000" & names(obs.gen) != "0"]
nchar(names(obs.gen[1])) %% 2
splitnum<-nchar(names(obs.gen[1]))/2
splitnum
allele.names<-levels(as.factor(c(substr(names(obs.gen),1,splitnum),
substr(names(obs.gen),splitnum+1,nchar(names(obs.gen[1]))))))
allele.names
alleles<-cbind(substr(genotypes,1,splitnum),
substr(genotypes,splitnum+1,nchar(names(obs.gen[1]))))
alleles
alleles<-alleles[alleles != "0" & alleles != "00" &
alleles != "000" & alleles!= "0000" &
alleles != "00000" & alleles != "000000"]
alleles
obs<-summary(as.factor(alleles))
obs
length(obs) < length(allele.names)
num.missing<-length(allele.names[!(allele.names%in% names(obs))])
num.missing
allele.names[!(allele.names%in% names(obs))]
AlleleCounts<-c(obs,rep(0,num.missing))
AlleleCounts
names(AlleleCounts)<-c(names(obs)[names(obs) %in% allele.names],
allele.names[!(allele.names%in% names(obs))])
names
AlleleCounts
counts<-allele.counts(genotypes)
counts
obs.af<-counts/sum(counts)
obs.af
AlleleCounts[order(AlleleCounts)]
AlleleCounts
names(AlleleCounts)<-c("A","B")
AlleleCounts
AlleleCounts[order(AlleleCounts)]
AlleleCounts[order(names(AlleleCounts))]
AlleleCounts<-AlleleCounts[order(names(AlleleCounts))]
rm(list=ls())
library(fsthet)
setwd("~/Projects/fst_outliers/results/numerical_analysis_selection/")
gpop<-my.read.genepop("Nm1.d2.s20.ds0.genepop")#"Nm0.1.d2.s2.genepop.step.loci"
f1<-calc.actual.fst(gpop,"fst")
f2<-calc.actual.fst(gpop,"var")
f3<-calc.actual.fst(gpop,"theta")
f4<-calc.actual.fst(gpop,"betahat")
los<-read.delim("Nm1.d2.s20.ds0.genepop.step.loci") #the lositan data
plot(los$Het,los$Fst,ylim=c(0,1),pch=19)
points(f1$Ht,f1$Fst,pch=1,col="orchid")
points(f2$Ht,f2$Fst,pch=2,col="cornflowerblue")
points(f3$Ht,f3$Fst,pch=3,col="forestgreen")
points(f4$Ht,f4$Fst,pch=4,col="goldenrod")
library(fsthet)
gpop<-my.read.genepop("Nm1.d2.s20.ds0.genepop")#"Nm0.1.d2.s2.genepop.step.loci"
f1<-calc.actual.fst(gpop,"fst")
f2<-calc.actual.fst(gpop,"var")
f3<-calc.actual.fst(gpop,"theta")
f4<-calc.actual.fst(gpop,"betahat")
los<-read.delim("Nm1.d2.s20.ds0.genepop.step.loci") #the lositan data
plot(los$Het,los$Fst,ylim=c(0,1),pch=19)
points(f1$Ht,f1$Fst,pch=1,col="orchid")
points(f2$Ht,f2$Fst,pch=2,col="cornflowerblue")
points(f3$Ht,f3$Fst,pch=3,col="forestgreen")
points(f4$Ht,f4$Fst,pch=4,col="goldenrod")
f<-calc.actual.fst(gpop,"wcc") #run with corrected weir & cockerham
f.n<-calc.actual.fst(gpop,"wright") #run with nei's formulation of wright's fst
points(f$Ht,f$Fst,col="orchid",pch=5)
points(f.n$Ht,f.n$Fst,col="forestgreen",pch=6)
setwd("B://ubuntushare//fst_outliers//results//numerical_analysis_selection")
getwd()
setwd("../numerical_analysis/")
pop.list<-list(
read.delim("Nm1.d2.n100.genepop.step.loci"),
read.delim("Nm1.d2.n500.genepop.step.loci"),
read.delim("Nm1.d2.n1000.genepop.step.loci"),
read.delim("Nm1.d5.n100.genepop.step.loci"),
read.delim("Nm1.d5.n500.genepop.step.loci"),
read.delim("Nm1.d5.n1000.genepop.step.loci"))
names(pop.list)<-c("Nm1.d2.n100","Nm1.d2.n500","Nm1.d2.n1000",
"Nm1.d5.n100","Nm1.d5.n500","Nm1.d5.n1000")
pop.cis<-list(
read.delim("Nm1.d2.n100.genepop.step.ci"),
read.delim("Nm1.d2.n500.genepop.step.ci"),
read.delim("Nm1.d2.n1000.genepop.step.ci"),
read.delim("Nm1.d5.n100.genepop.step.ci"),
read.delim("Nm1.d5.n500.genepop.step.ci"),
read.delim("Nm1.d5.n1000.genepop.step.ci"))
par(mfrow = c(2, 3),cex = 0.6,mar = c(0, 0, 0, 0),
oma = c(4, 4.5, 1.5, 0.5), tcl = -0.25,mgp = c(2, 0.6, 0))
for (i in 1:length(pop.list)) {
#plot(seq(0,0.6,0.06),seq(0,1,0.1), axes = FALSE, type = "n")
y.min<-min(min(pop.cis[[i]][,2]),min(pop.list[[i]]$Fst))
y.max<-(max(pop.list[[i]]$Fst)+2*sd(pop.list[[i]]$Fst))
if(y.max>1)
y.max<-1
plot(pop.list[[i]]$Het,pop.list[[i]]$Fst,las=1,xlab="",ylab="",
col="black",pch=19,xaxt="n", xlim=c(0,1),ylim=c(0,y.max))
points(pop.cis[[i]]$Het,pop.cis[[i]][,2],col="red",type="l")
points(pop.cis[[i]]$Het, pop.cis[[i]][,4],col="red",type="l")
Nm<-strsplit(strsplit(names(pop.list)[i], "Nm")[[1]][2],"[._]")[[1]][1]
exp.fst<-round(1/((4*as.numeric(Nm))+1),digits=4)
avg.fst<-round(mean(pop.list[[i]]$Fst[pop.list[[i]]$Het > 0]),digits=4)
leg.nms<-c(bquote(Exp.~italic(F)[ST]~"="~.(exp.fst)),
bquote(Mean~italic(F)[ST]~"="~.(avg.fst)))
legend("topleft",legend=as.expression(leg.nms),bty="n")
if (i %in% c(4,5,6))
axis(1, at = seq(0,1,0.1))
if(i==1){
mtext("N = 100", 3,cex=.75)
mtext("2 Demes",2,line=1.75,cex=.75)}
if(i==2)
mtext("N = 500",3,cex=.75)
if(i==3){
mtext("N=1000",3,cex=.75)
}
if(i==4)
mtext("5 Demes",2,line=1.75,cex=.75)
}
mtext(expression(italic(H)[italic(B)]),1,outer=T,line=2,cex=.75)
mtext(expression(italic(hat(beta))),2,outer=T,line=2.5,cex=.75)
plot(f1$Ht,f4$Ht)
getwd()
setwd("../numerical_analysis_genepop/")
list.files(pattern="Nm1.*.genepop$")
list.files(pattern="Nm1\\..*.genepop$")
nm1.gpop<-list.files(pattern="Nm1\\..*.genepop$")
length(nm1.gpop)
plot(f1$Ht,f4$Ht,pch=19,bty="L")
?corr
?cor
cor(f1$Ht,f4$Ht)
rcorr
?rcorr
??rcorr
cor.test(f1$Ht,f4$Ht)
str(cor.test(f1$Ht,f4$Ht))
p<-cor.test(f1$Ht,f4$Ht)$p.value
p<-cor.test(f1$Ht,f4$Ht)$p.value
r<-cor.test(f1$Ht,f4$Ht)$estimate
r
p
legend("topleft",c(expression("p~=~"p),expression(),sub("(.*).genepop")),
col="cornflowerblue",bty='n')
paste("p = ", p,sep="")
expression(italic(p)~=~p)
expression(italic(p)~==~.(p))
expression(italic(p)==.(p))
legend("topleft",c(paste("p = ", p,sep=""),paste("r = ",r,sep=""),sub("(.*).genepop")),
col="cornflowerblue",bty='n')
legend("topleft",col="cornflowerblue",bty='n',
c(paste("p = ", p,sep=""),paste("r = ",r,sep=""),sub("(.*).genepop","\\1",gpop.file)))
legend("topleft",col="cornflowerblue",bty='n',
c(paste("p = ", p,sep=""),paste("r = ",r,sep=""),sub("(.*).genepop","\\1",nm1.gpop[1])))
legend("topleft",txt.col="cornflowerblue",bty='n',
c(paste("p = ", p,sep=""),paste("r = ",r,sep=""),sub("(.*).genepop","\\1",gpop.file)))
legend("topleft",col="cornflowerblue",bty='n',
c(expression(italic(p)==.(p)),paste("r = ",r,sep=""),sub("(.*).genepop","\\1",gpop.file)))
legend("topleft",col="cornflowerblue",bty='n',
c(expression(italic(p)==.(p)),paste("r = ",r,sep=""),sub("(.*).genepop","\\1",nm1.gpop[1])))
plot(f1$Ht,f4$Ht,pch=19,bty="L")
legend("topelft",col="cornflowerblue",bty='n',
c(expression(italic(p)==.(p)),paste("r = ",r,sep=""),sub("(.*).genepop","\\1",nm1.gpop[1])))
legend("topleft",col="cornflowerblue",bty='n',
c(expression(italic(p)==.(p)),paste("r = ",r,sep=""),sub("(.*).genepop","\\1",nm1.gpop[1])))
legend("topleft",col="cornflowerblue",bty='n',
c(expression(italic(p)==.(p)%.%),paste("r = ",r,sep=""),sub("(.*).genepop","\\1",nm1.gpop[1])))
legend("topleft",col="cornflowerblue",bty='n',
c(bquote(paste(italic(p),==.(p)%.%)),paste("r = ",r,sep=""),sub("(.*).genepop","\\1",nm1.gpop[1])))
legend("topleft",col="cornflowerblue",bty='n',
c(bquote(paste(italic(p),=.(p)%.%)),paste("r = ",r,sep=""),sub("(.*).genepop","\\1",nm1.gpop[1])))
legend("topleft",col="cornflowerblue",bty='n',
c(bquote(paste(italic(p)==.(p)%.%)),paste("r = ",r,sep=""),sub("(.*).genepop","\\1",nm1.gpop[1])))
legend("topleft",col="cornflowerblue",bty='n',
c(bquote(italic(p==.(p)%.%)),paste("r = ",r,sep=""),sub("(.*).genepop","\\1",nm1.gpop[1])))
legend("topleft",col="cornflowerblue",bty='n',
c(bquote(italic(p==.(p))),paste("r = ",r,sep=""),sub("(.*).genepop","\\1",nm1.gpop[1])))
bquote(italic(p==.(p)))
substitute(paste(italic("p"),p),list(p=p))
eval(substitute(paste(italic("p"),p),list(p=p)))
legend("topleft",col="cornflowerblue",bty='n',
c(paste("p = ", round(p,3),sep=""),paste("r = ",round(r,3),sep=""),sub("(.*).genepop","\\1",nm1.gpop[1])))
legend("topleft",col="cornflowerblue",bty='n',
c(bquote(italic(p)==.(p)),paste("p = ", round(p,3),sep=""),paste("r = ",round(r,3),sep=""),sub("(.*).genepop","\\1",nm1.gpop[1])))
legend("topleft",col="cornflowerblue",bty='n',
legend=c(bquote(italic(p)==.(p)),paste("p = ", round(p,3),sep=""),paste("r = ",round(r,3),sep=""),sub("(.*).genepop","\\1",nm1.gpop[1])))
plot(f1$Ht,f4$Ht,pch=19,bty="L")
legend("topleft",col="cornflowerblue",bty='n',
legend=c(bquote(italic(p)==.(p)),paste("p = ", round(p,3),sep=""),paste("r = ",round(r,3),sep=""),sub("(.*).genepop","\\1",nm1.gpop[1])))
par(mfrow=c(7,4))
lapply(nm1.gpop,function(gpop.file){
gpop<-my.read.genepop(gpop.file)
f1<-calc.actual.fst(gpop,"fst")
f4<-calc.actual.fst(gpop,"betahat")
plot(f1$Ht,f4$Ht,pch=19,bty="L")
r<-cor.test(f1$Ht,f4$Ht)$estimate
p<-cor.test(f1$Ht,f4$Ht)$p.value
legend("topleft",col="cornflowerblue",bty='n',
legend=c(paste("p = ", round(p,3),sep=""),paste("r = ",round(r,3),sep=""),sub("(.*).genepop","\\1",nm1.gpop[1])))
})
dev.off()
png("supplemental_fig2.png",height=8,width=5,units="in",res=300)
par(mfrow=c(7,4),mar=c(2,2,2,2),oma=c(2,2,2,2))
lapply(nm1.gpop,function(gpop.file){
gpop<-my.read.genepop(gpop.file)
f1<-calc.actual.fst(gpop,"fst")
f4<-calc.actual.fst(gpop,"betahat")
plot(f1$Ht,f4$Ht,pch=19,bty="L")
r<-cor.test(f1$Ht,f4$Ht)$estimate
p<-cor.test(f1$Ht,f4$Ht)$p.value
legend("topleft",col="cornflowerblue",bty='n',
legend=c(paste("p = ", round(p,3),sep=""),paste("r = ",round(r,3),sep=""),sub("(.*).genepop","\\1",nm1.gpop[1])))
})
dev.off()
png("supplemental_fig2.png",height=8,width=5,units="in",res=300)
par(mfrow=c(7,4),mar=c(1,1,1,1),oma=c(2,2,1,1),cex=0.5)
lapply(nm1.gpop,function(gpop.file){
gpop<-my.read.genepop(gpop.file)
f1<-calc.actual.fst(gpop,"fst")
f4<-calc.actual.fst(gpop,"betahat")
plot(f1$Ht,f4$Ht,pch=19,bty="L",cex.axis=1.25)
r<-cor.test(f1$Ht,f4$Ht)$estimate
p<-cor.test(f1$Ht,f4$Ht)$p.value
legend("topleft",col="cornflowerblue",bty='n',cex=1.25,
legend=c(paste("p = ", round(p,3),sep=""),paste("r = ",round(r,3),sep=""),sub("(.*).genepop","\\1",gpop.file))
})
mtext(expression(italic(H)[T]),1,cex=0.75)
mtext(expression(italic(H)[B]),1,cex=0.75)
dev.off()
png("supplemental_fig2.png",height=8,width=5,units="in",res=300)
par(mfrow=c(7,4),mar=c(1,1,1,1),oma=c(2,2,1,1),cex=0.5)
lapply(nm1.gpop,function(gpop.file){
gpop<-my.read.genepop(gpop.file)
f1<-calc.actual.fst(gpop,"fst")
f4<-calc.actual.fst(gpop,"betahat")
plot(f1$Ht,f4$Ht,pch=19,bty="L",cex.axis=1.25)
r<-cor.test(f1$Ht,f4$Ht)$estimate
p<-cor.test(f1$Ht,f4$Ht)$p.value
legend("topleft",col="cornflowerblue",bty='n',cex=1.25,
legend=c(paste("p = ", round(p,3),sep=""),paste("r = ",round(r,3),sep=""),sub("(.*).genepop","\\1",gpop.file))
})
mtext(expression(italic(H)[T]),1,cex=0.75)
mtext(expression(italic(H)[B]),1,cex=0.75)
dev.off()
png("supplemental_fig2.png",height=8,width=5,units="in",res=300)
par(mfrow=c(7,4),mar=c(1,1,1,1),oma=c(2,2,1,1),cex=0.5)
lapply(nm1.gpop,function(gpop.file){
gpop<-my.read.genepop(gpop.file)
f1<-calc.actual.fst(gpop,"fst")
f4<-calc.actual.fst(gpop,"betahat")
plot(f1$Ht,f4$Ht,pch=19,bty="L",cex.axis=1.25)
r<-cor.test(f1$Ht,f4$Ht)$estimate
p<-cor.test(f1$Ht,f4$Ht)$p.value
legend("topleft",col="cornflowerblue",bty='n',cex=1.25,
legend=c(paste("p = ", round(p,3),sep=""),paste("r = ",round(r,3),sep=""),sub("(.*).genepop","\\1",gpop.file)))
})
mtext(expression(italic(H)[T]),1,cex=0.75)
mtext(expression(italic(H)[B]),1,cex=0.75)
dev.off()
png("supplemental_fig2.png",height=8,width=5,units="in",res=300)
par(mfrow=c(7,4),mar=c(1,1,1,1),oma=c(2,2,1,1),cex=0.5)
lapply(nm1.gpop,function(gpop.file){
gpop<-my.read.genepop(gpop.file)
f1<-calc.actual.fst(gpop,"fst")
f4<-calc.actual.fst(gpop,"betahat")
plot(f1$Ht,f4$Ht,pch=19,bty="L",cex.axis=1.25)
r<-cor.test(f1$Ht,f4$Ht)$estimate
p<-cor.test(f1$Ht,f4$Ht)$p.value
legend("topleft",bty='n',cex=1.25,
legend=c(paste("p = ", round(p,3),sep=""),paste("r = ",round(r,3),sep="")))
legend(legend=sub("(.*).genepop","\\1",gpop.file),bty='n',"bottomright",cex=1.25)
})
mtext(expression(italic(H)[T]),1,cex=0.75,outer=T)
mtext(expression(italic(H)[B]),1,cex=0.75,outer=T)
dev.off()
png("supplemental_fig2.png",height=8,width=5,units="in",res=300)
par(mfrow=c(7,4),mar=c(1,1,1,1),oma=c(2,3,1,1),cex=0.5)
lapply(nm1.gpop,function(gpop.file){
gpop<-my.read.genepop(gpop.file)
f1<-calc.actual.fst(gpop,"fst")
f4<-calc.actual.fst(gpop,"betahat")
plot(f1$Ht,f4$Ht,pch=19,bty="L",cex.axis=1.25)
r<-cor.test(f1$Ht,f4$Ht)$estimate
p<-cor.test(f1$Ht,f4$Ht)$p.value
legend("topleft",bty='n',cex=1.25,
legend=c(paste("p = ", round(p,3),sep=""),paste("r = ",round(r,3),sep="")))
legend(legend=sub("(.*).genepop","\\1",gpop.file),bty='n',"bottomright",cex=1.25)
})
mtext(expression(italic(H)[T]),1,cex=0.75,outer=T,line=2)
mtext(expression(italic(H)[B]),1,cex=0.75,outer=T,line=2)
dev.off()
par(mfrow=c(7,4),mar=c(1,1,1,1),oma=c(2,3,1,1),cex=0.5)
mtext(expression(italic(H)[T]),1,cex=0.75,outer=T,line=1.5)
dev.off()
pdf("supplemental_fig2.pdf")
par(mfrow=c(7,4),mar=c(1,1,1,1),oma=c(2,3,1,1),cex=0.5)
lapply(nm1.gpop,function(gpop.file){
gpop<-my.read.genepop(gpop.file)
f1<-calc.actual.fst(gpop,"fst")
f4<-calc.actual.fst(gpop,"betahat")
plot(f1$Ht,f4$Ht,pch=19,bty="L",cex.axis=1.25)
r<-cor.test(f1$Ht,f4$Ht)$estimate
p<-cor.test(f1$Ht,f4$Ht)$p.value
legend("topleft",bty='n',cex=1.25,
legend=c(paste("p = ", round(p,3),sep=""),paste("r = ",round(r,3),sep="")))
legend(legend=sub("(.*).genepop","\\1",gpop.file),bty='n',"bottomright",cex=1.25)
})
mtext(expression(italic(H)[T]),1,cex=0.75,outer=T,line=1.5)
mtext(expression(italic(H)[B]),1,cex=0.75,outer=T,line=-1.5)
dev.off()
pdf("supplemental_fig2.pdf")
par(mfrow=c(7,4),mar=c(1,1,1,1),oma=c(2.5,2.5,1,1),cex=0.5)
lapply(nm1.gpop,function(gpop.file){
gpop<-my.read.genepop(gpop.file)
f1<-calc.actual.fst(gpop,"fst")
f4<-calc.actual.fst(gpop,"betahat")
plot(f1$Ht,f4$Ht,pch=19,bty="L",cex.axis=1.25)
r<-cor.test(f1$Ht,f4$Ht)$estimate
p<-cor.test(f1$Ht,f4$Ht)$p.value
legend("topleft",bty='n',cex=1.25,
legend=c(paste("p = ", round(p,3),sep=""),paste("r = ",round(r,3),sep="")))
legend(legend=sub("(.*).genepop","\\1",gpop.file),bty='n',"bottomright",cex=1.25)
})
mtext(expression(italic(H)[T]),1,cex=0.75,outer=T,line=1.5)
mtext(expression(italic(H)[B]),2,cex=0.75,outer=T,line=1.5)
dev.off()
pdf("supplemental_fig2.pdf")
par(mfrow=c(7,4),mar=c(1,1,1,1),oma=c(2.5,2.5,1,1),cex=0.5)
lapply(nm1.gpop,function(gpop.file){
gpop<-my.read.genepop(gpop.file)
f1<-calc.actual.fst(gpop,"fst")
f4<-calc.actual.fst(gpop,"betahat")
plot(f1$Ht,f4$Ht,pch=19,bty="L",cex.axis=1.25)
r<-cor.test(f1$Ht,f4$Ht)$estimate
p<-cor.test(f1$Ht,f4$Ht)$p.value
legend("topleft",bty='n',cex=1.25,
legend=c(paste("p = ", round(p,3),sep=""),paste("r = ",round(r,3),sep="")))
legend(legend=sub("(.*).genepop","\\1",gpop.file),bty='n',"bottomright",cex=1.25)
})
mtext(expression(italic(H)[T]),1,cex=0.75,outer=T,line=1.5)
mtext(expression(italic(H)[B]),2,cex=0.75,outer=T,line=1)
dev.off()
png("supplemental_fig2.png",height=8,width=6,units="in",res=300)
par(mfrow=c(7,4),mar=c(1,1,1,1),oma=c(2.5,2.5,1,1),cex=0.5)
lapply(nm1.gpop,function(gpop.file){
gpop<-my.read.genepop(gpop.file)
f1<-calc.actual.fst(gpop,"fst")
f4<-calc.actual.fst(gpop,"betahat")
plot(f1$Ht,f4$Ht,pch=19,bty="L",cex.axis=1.25)
r<-cor.test(f1$Ht,f4$Ht)$estimate
p<-cor.test(f1$Ht,f4$Ht)$p.value
legend("topleft",bty='n',cex=1.25,
legend=c(paste("p = ", round(p,3),sep=""),paste("r = ",round(r,3),sep="")))
legend(legend=sub("(.*).genepop","\\1",gpop.file),bty='n',"bottomright",cex=1.25)
})
mtext(expression(italic(H)[T]),1,cex=0.75,outer=T,line=1.5)
mtext(expression(italic(H)[B]),2,cex=0.75,outer=T,line=1)
dev.off()
load(gpop)
load("gpop.rda")
gfile<-system.file("extdata", "example.genepop.txt",package = 'fsthet')
gpop<-my.read.genepop(gfile)
library(fsthet)
fsts<-calc.actual.fst(gpop,"fst")
save(fsts,"fsts.rda")
save(fsts,file="fsts.rda")
fsts.theta<-calc.actual.fst(gpop,"theta")
save(fsts.theta,file="fsts.theta.rda")
fsts.beta<-calc.actual.fst(gpop,"var")
save(fsts.beta,file="fsts.beta.rda")
fsts.betahat<-calc.actual.fst(gpop,"betahat")
save(fsts.betahat,file="fsts.betahat.rda")
getwd()
list(pattern="rda")
list.files(pattern="rda")
setwd("../../fsthet/data/")
save(fsts,"fsts.rda")
save(fsts,file="fsts.rda")
save(fsts.betahat,file="fsts.betahat.rda")
save(fsts.beta,file="fsts.beta.rda")
save(fsts.theta,file="fsts.theta.rda")
quant.out<-fst.boot(gpop, bootstrap = FALSE)
save(quant.out,file="quant.out.rda")
cis<-find.quantiles(bins = bins$bins,bin.fst = bins$bin.fst)
bins<-make.bins(fsts)
cis<-find.quantiles(bins = bins$bins,bin.fst = bins$bin.fst)
cis.list<-find.quantiles(bins = bins$bins,bin.fst = bins$bin.fst,ci=c(0.01,0.05))
str(cis.list)
save(bins,file="bins.rda")
str(cis)
save(cis,file="cis.rda")
save(cis.list,file="cis.list.rda")
str(quant.out)
str(cis.list)
str(bins)
library(fsthet)
devtools::build_vignettes()
library(devtools)
library(rmarkdown)
render("../vignettes/fsthet-vignette.Rmd")
render("../vignettes/fsthet-vignette.Rmd")
render("../vignettes/fsthet-vignette.Rmd")
render("../vignettes/fsthet-vignette.Rmd")
library(fsthet)
library(fsthet)
setwd("../../")
getwd()
