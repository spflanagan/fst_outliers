install.packages("knitr")
library(devtools)
library(knitr)
setwd("../")
install.packages("Rtools")
install.packages("rtools")
library(fsthey)
library(fsthet)
library(fsthet)
library(rmarkdown)
render("vignettes/fsthet-vignette.Rmd")
render("vignettes/fsthet-vignette.Rmd")
library(fsthet)
gfile<-system.file("extdata", "example.genepop.txt",package = 'fsthet')
gpop<-my.read.genepop(gfile)
library(fsthet)
gfile<-system.file("extdata", "example.genepop.txt",package = 'fsthet')
gpop<-my.read.genepop(gfile)
fsts<-calc.actual.fst(gpop)
head(fsts)
str(fsts)
calc.actual.fst<-function(df, fst.choice="Wright"){
fst.options<-c("Wright", "wright","WRIGHT","W","w","WeirCockerham","WC", "weircockerham","wc",
"WeirCockerhamCorrected","WCC", "weircockerhamcorrected","wcc", "corrected")
if(!(fst.choice %in% fst.options)) { stop("Fst choice not an option. Use fst.options.print() to see options.")}
fsts<-data.frame(Locus=character(),Ht=numeric(),Fst=numeric(),
stringsAsFactors=F)
if(fst.choice == "Wright" | fst.choice == "WRIGHT" | fst.choice == "wright" | fst.choice == "W" | fst.choice == "w"){
for(i in 3:ncol(df)){
fsts[i-2,]<-c(colnames(df)[i],calc.fst(df,i))
}
}
if(fst.choice == "WeirCockerham" | fst.choice == "WC" | fst.choice == "weircockerham" | fst.choice == "wc"){
for(i in 3:ncol(df)){
fsts[i-2,]<-c(colnames(df)[i],wc.fst(df,i))
}
}
if(fst.choice == "WeirCockerhamCorrected" | fst.choice == "WCC" |
fst.choice == "weircockerhamcorrected" | fst.choice == "wcc" | fst.choice == "corrected"){
for(i in 3:ncol(df)){
fsts[i-2,]<-c(colnames(df)[i],wc.corr.fst(df,i))
}
}
fsts<-data.frame(Locus=as.character(fsts$Locus),Ht=as.numeric(fsts$Ht),Fst=as.numeric(fsts$Fst),
stringsAsFactors=F)
return(fsts)
}
fsts<-calc.actual.fst(gpop)
str(fsts)
bins<-make.bins(fsts)
cis<-find.quantiles(bins = bins$bins,bin.fst = bins$bin.fst)
str(cis)
library(rmarkdown)
render("vignettes/fsthet-vignette.Rmd")
render("vignettes/fsthet-vignette.Rmd")
library(fsthet)
gfile<-system.file("extdata", "example.genepop.txt",package = 'fsthet')
gpop<-my.read.genepop(gfile)
library(devtools)
library(fsthet)
install.packages("fsthet")
library(fsthet)
gfile<-system.file("extdata", "example.genepop.txt",package = 'fsthet')
gpop<-my.read.genepop(gfile)
df<-gpop
i<-3
df.split<-split(df[,i],df[,1])
af<-do.call("rbind",lapply(df.split,calc.allele.freq))
af
mean(af[,1])
lapply(df.split,nrow)
str(df.split)
lapply(df.split,length)
mean(unlist(lapply(df.split,length)))
Y<-sum(af[,1])*sum(af[,1])+sum(1-af[,1])*sum(1-af[,1])
Y
sum(af[,1])
sum(1-af[,1])
sum(af[,2])
1.44^2
3.56^2
X<-sum(af[,1]^2)+sum((1-af[,1])^2)
X
af[,1^2]
af[,1]^2
sum((1-af[,1])^2)
source('~/GitHub/fsthet_analysis/fsthet/R/fsthet.R')
plot(fsts$Ht, fsts$Fst,xlab="Ht",ylab="Fst",pch=19)
fsts<-calc.actual.fst(gpop)
library(fsthet)
fsts<-calc.actual.fst(gpop)
head(fsts)
plot(fsts$Ht, fsts$Fst,xlab="Ht",ylab="Fst",pch=19)
